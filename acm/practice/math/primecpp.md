# prime.cpp


### 一些性质
* 除了 2 和 3，所有素数满足 $$p\equiv \pm1\ mod\ 6$$ 

### 素数线性筛

需要满足以下两个条件：

* 每个合数都会被筛除
* 每个合数都只会被筛一次

**规定每一个合数都只会被它的最小素因数筛除，能满足上述两个条件**

对于一个数**X**，$$X=p_1\times p_2\times ... \times p_n\{p为素数，从小到大排序\}$$，可以筛掉$p_x\times X\{p_X是小于p_1的所有素数\}$

若$$p_x$$大于$$p_1$$,则$$p_x\times X$$的最小素因子是$$p_1$$，不满足**规定**--->```if(X%primex==0)break;```

### 素数测试

* 费马测试

  根据费马小定理，$$if\ n\ is\ prime\rightarrow a^{n-1}\equiv 1\ mod\ n $$，任意取多个a，若n都满足条件，则n极大概率是一个素数

* Miller-Rabin 测试

###素数表

* 表1

  > g 是 mod $$r*2^k+1$$的原根

| $$r*2^k+1$$ | r    | k    | g    |
| :---------: | :--: | :--: | :--: |
|3|1|1|2|
|5|1|2|2|
|17|1|4|3|
|97|3|5|5|
|193|3|6|5|
|257|1|8|3|
|7681|15|9|17|
|12289|3|12|11|
|40961|5|13|3|
|65537|1|16|3|
|786433|3|18|10|
|5767169|11|19|3|
|7340033|7|20|3|
|23068673|11|21|3|
|104857601|25|22|3|
|167772161|5|25|3|
|469762049|7|26|3|
|998244353|119|23|3|
|1004535809|479|21|3|
|2013265921|15|27|31|
|2281701377|17|27|3|
|3221225473|3|30|5|
|75161927681|35|31|3|
|77309411329|9|33|7|
|206158430209|3|36|22|
|2061584302081|15|37|7|
|2748779069441|5|39|3|
|6597069766657|3|41|5|
|39582418599937|9|42|5|
|79164837199873|9|43|5|
|263882790666241|15|44|7|
|1231453023109121|35|45|3|
|1337006139375617|19|46|3|
|3799912185593857|27|47|5|
|4222124650659841|15|48|19|
|7881299347898369|7|50|6|
|31525197391593473|7|52|3|
|180143985094819841|5|55|6|
|1945555039024054273|27|56|5|
|4179340454199820289|29|57|3|

* 表2
|NIL|
|:---:|
|103127047|
|984466009|
|653452649|
|378452077|
|475201777|
|915279049|
|379146109|
|110954237|
|510750281|
|392857511|
|296005727|
|378297167|
|811592627|
|222398747|
|100812793|
|906533717|
|336385711|
|989985119|
|639420011|
|289273939|
