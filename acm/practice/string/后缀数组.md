# 后缀数组刘汝佳模板理解
> 倍增算法思想并不难理解，但书上模板数组套数组很难一眼看明白，  
[这篇博客可以帮助理解](http://blog.csdn.net/jijijix/article/details/52319601) ，此处再加上我的一点理解
注：以蓝书P221代码为准

* 第一遍使用基数排序得到P220图3-28不难理解，图3-28最后一行数字的排名对应  
第一遍的sa数组

* 第一遍只是对单个字符进行了排序，接下来的操作都是对二元组进行排序

* 注释---**直接利用sa数组排序第二关键字**
设倍增算法的间距为k,k依次等于1,2,4,8...，可以发现，将第一遍得到的sa数组向左  
移动k为，缺位补0,得到的就是对应二元组第二元的信息，非0部分的排名就是原来的  
排名减去k,0部分的排名从n-k到n-1分别是0,1,2...，这两行便将第二元的排名放到了y  
数组中

* 注释---**基数排序第一关键字**
这个注释对我造成了误解（二元组排序为什么只排了第一关键字？）。其实这里有一  
个小trick。因为上一步已经对第二关键字进行了排序，所以对y数组从后面遍历（本  
段最后一行），得到的二元组（位置）是从大到小排的，所以只需从大到小排第一 元，  
最后组合的二元组肯定也是从大到小排的，依次将它们的排名装入sa数组(本段最后  
一行，前三行都是用基数排序对第一元排序)，变完成了一轮排序
* 注释---**根据sa和y数组计算新的x数组**
也就是计算不同二元组的数目，以此判断是否该终止排序或当作下一轮基数排序的依据